---
title: æ‰‹æŠŠæ‰‹æ•™ä½ ä½¿ç”¨ npm-link è½¯é“¾
date: 2022-07-27 13:39:08
updated: 2022-07-27 13:39:08
tags:
  - npm
  - npm-link
categories:
  - å·¥å…·å­¦ä¹ 
  - åŒ…ç®¡ç†å™¨
---

### æµ…è°ˆä¸€ä¸‹

å‰æ®µæ—¶é—´ï¼Œå¼€å‘äº†ä¸€ä¸ªç»„ä»¶ï¼Œéœ€è¦åœ¨æœ¬åœ°`debug`éªŒè¯ç›¸å…³åŠŸèƒ½ï¼Œæœ‰äº›çº ç»“æ˜¯ç”¨`npm link`è¿˜æ˜¯`npx link`ï¼Œäº¦æˆ–æ˜¯`npm install`ã€‚ã€‚ã€‚

æœ‰äº›å¿˜è®°äº†ç›¸å…³ç”¨æ³•ä»¥åŠå¸¦æ¥çš„å½±å“...è§‰å¾—è¿˜æ˜¯æœ‰å¿…è¦å†™ä¸€ç¯‡æ–‡ç« è®°å½•ä¸€ä¸‹è¿‡ç¨‹ï¼Œä»¥åŠæ–°çš„ä¸œè¥¿ã€‚ğŸ˜®â€ğŸ’¨ğŸ˜®â€ğŸ’¨ğŸ˜®â€ğŸ’¨

### `npm link`æ˜¯å¹²å•¥çš„ï¼Ÿ

[npm æ–‡æ¡£](https://docs.npmjs.com/cli/v7/commands/npm-link) ä¹Ÿæœ‰è¯´æ˜ï¼šä¸ºäº†æ–¹ä¾¿ä½ çš„è¿­ä»£æµ‹è¯•ï¼Œ`npm link`å°†åœ¨å…¨å±€çš„`node_modules`åˆ›å»ºä¸€ä¸ªæŒ‡å‘å½“å‰è‡ªå®šä¹‰çš„`npm`æ¨¡å—çš„è½¯é“¾æ¥ï¼Œå¹¶åœ¨ä½ éœ€è¦ä½¿ç”¨çš„åœ°æ–¹é€šè¿‡`npm link packagename`åˆ›å»ºä¸€ä¸ªä»å…¨å±€å®‰è£…çš„`package-name`åˆ°`å½“å‰æ–‡ä»¶å¤¹/node_modules`çš„ç¬¦å·é“¾æ¥ã€‚ä½ å¯¹è‡ªå®šä¹‰åŒ…çš„ä»»ä½•æ”¹åŠ¨éƒ½å°†åŒæ­¥åˆ°`link`åˆ°çš„é¡¹ç›®ä¸­ã€‚~~å¯ä»¥ç†è§£ä¸º mklink~~

<!-- more -->

### ç¬¬ä¸€è§†è§’å¸¦ä½ å­¦ä¹ `link`æŒ‡ä»¤

#### å‡†å¤‡å¥½é¢„å‘å¸ƒåŒ…

```bash
mkdir my-test-component-zhl
cd ./my-test-component-zhl
npm init -y

# å‡†å¤‡å…¥å£æ–‡ä»¶ index
# (() => {
#   console.log('è¿™æ˜¯æˆ‘çš„ç»„ä»¶æ¨¡å—');
# })();
```

#### å‡†å¤‡ä¸€ä¸ªç”¨äºæµ‹è¯•çš„é¡¹ç›®\*

```bash
cd ../
mkdir my-test-project
cd ./my-test-project
npm init -y
```

#### ä¸ºé¢„å‘å¸ƒåŒ…åˆ›å»ºè½¯é“¾æ¥

```bash
cd ../my-test-component-zhl
npm link
```

ç»“æœé¢„è§ˆï¼š

[![npm-link-p1](/images/tools/npm-link/p1.png)](/images/tools/npm-link/p1.png)

é“¾æ¥çš„ä½ç½®å°±æ˜¯ä½ `nodejs`å®‰è£…ç›®å½•ä¸‹çš„`node_modules`ç›®å½•ä¸‹ï¼ŒæŒ‡å‘äº†å½“å‰çš„ç»„ä»¶ã€‚

#### åœ¨é¡¹ç›®ä¸­å¼•ç”¨è¿™ä¸ªé¢„å‘å¸ƒåŒ…

ä½ ä¼šå‘ç°ï¼Œ`link`çš„åŒ…å¹¶ä¸ä¼šåœ¨`package.json`çš„`dependencies`é‡Œå‡ºç°ã€‚

```bash
cd ../my-test-project
npm link my-test-component-zhl
```

ç»“æœé¢„è§ˆï¼š

[![npm-link-p2](/images/tools/npm-link/p2.png)](/images/tools/npm-link/p2.png)
[![npm-link-p3](/images/tools/npm-link/p3.png)](/images/tools/npm-link/p3.png)

å®é™…ä½¿ç”¨è°ƒè¯•ï¼š

```javascript
require('my-test-component-zhl');
```

[![npm-link-p4](/images/tools/npm-link/p4.png)](/images/tools/npm-link/p4.png)

#### è°ƒè¯•

ä¿®æ”¹`my-test-component-zhl`çš„å†…å®¹ï¼Œä¼šåŒæ­¥æ›´æ–°åˆ°å½“å‰å¼•ç”¨çš„é¡¹ç›®ä¸­...å¾ˆæ–¹ä¾¿ã€‚

æ•ˆæœï¼š

[![npm-link-p5](/images/tools/npm-link/p5.png)](/images/tools/npm-link/p5.png)

#### è§£é™¤`link`

```bash
npm unlink --no-save packagename && npm install
```

æŸ¥é˜…äº†æ–‡æ¡£ï¼Œå‘ç°`unlink`å…¶å®æ˜¯`uninstall`çš„åˆ«åã€‚[-> æˆ³è¿™é‡Œ](https://docs.npmjs.com/cli/v7/commands/npm-uninstall)

å½“ç„¶ï¼Œå¦‚æœä½ ä¸éœ€è¦`link`è¯¥ç»„ä»¶åŒ…è¿›è¡Œæµ‹è¯•æ—¶ï¼Œå»ºè®®ä½ åŒæ—¶ä¹Ÿå¸è½½æ‰`link`åˆ°å…¨å±€çš„åŒ…ã€‚å¦‚ä¸‹ï¼š

```bash
cd ../my-test-component-zhl
npm unlink [-g]
```

### è¯´è¯´`npm link`çš„ç¼ºç‚¹

å¥½ç”¨ç¡®å®æ˜¯å¥½ç”¨ï¼Œä½†æ˜¯ä¹Ÿæœ‰å‡ ä¸ªç¼ºç‚¹ï¼ˆæ§½ç‚¹ï¼‰ï¼š

<details>
<summary>å»ºç«‹äº† link è¿‡åï¼Œè·¨ node ç‰ˆæœ¬ä½¿ç”¨å®¹æ˜“å‡ºé”™</summary>

å…¶å®è¿™ä¸ªåœ¨æˆ‘æœ¬æœºä¸Šæ²¡æœ‰é‡åˆ°ï¼Œå‰é¢æµ‹è¯•çš„æ—¶å€™ï¼Œç»†å¿ƒçš„ä¼™ä¼´å¯èƒ½ä¹Ÿå‘ç°äº†ï¼Œ`link`çš„`global`åœ°å€å¹¶æ²¡æœ‰å¸¦`node`ç‰ˆæœ¬ä¿¡æ¯ï¼ˆå¹¶ä¸æ˜¯åœ¨`nvm/nodeversion/node_modules`ä¸‹ï¼Œæ„å‘³ç€æˆ‘æ¢ä¸€ä¸ª`node`çš„ç‰ˆæœ¬ï¼Œè½¯é“¾æ¥ä»ç„¶æ˜¯å­˜åœ¨ä¸”æœ‰æ•ˆçš„ã€‚ğŸ˜®â€ğŸ’¨ğŸ˜®â€ğŸ’¨ğŸ˜®â€ğŸ’¨ å¦‚ä½•åšåˆ°çš„ï¼Ÿ~~å°ä¼™ä¼´å¯ä»¥è‡ªå·±éªŒè¯ä¸€ä¸‹æ˜¯å¦å¯è¡Œ~~

é…ç½®`npm`çš„å…¨å±€å®‰è£…ä½ç½®ï¼š

> npm config set prefix xxx

</details>

<details>
<summary>link å¤±è´¥ä¸ä¼šæŠ¥é”™å¹¶ä¸”ä¼šå›é€€åˆ°ç›´æ¥ä» npm ä»“åº“è¿›è¡Œå®‰è£…</summary>

è¿™ä¸ªç¡®å®ï¼Œå¦‚æœ`link`æœ¬åœ°é¢„å‘å¸ƒåŒ…å¤±è´¥ï¼Œ`npm`ä¼šå…¨å±€å®‰è£…ä¸€ä¸ªä½ `link çš„ packagename`åŒ…ï¼Œç„¶åå†å»ºç«‹è½¯é“¾æ¥ï¼Œå¦‚æœ`npm-registry`ä»“åº“ä¹Ÿæ²¡æœ‰è¿™ä¸ªåŒ…ï¼Œæ‰ä¼šæŠ›å¼‚å¸¸ã€‚ğŸ’€ğŸ’€ğŸ’€ ~~æ½œåœ¨é—®é¢˜ï¼Œä¸å®¹æ˜“å‘ç°ï¼Œå½“ç„¶ä½ å¯ä»¥é€šè¿‡ä¸ºè‡ªå·±æ¨¡å—æ·»åŠ ç§æœ‰å‰ç¼€é¿å…è¿™ä¸€é—®é¢˜~~

</details>

<details>
<summary>ä¼šæœ‰é¢„æœŸä¹‹å¤–çš„äºŒè¿›åˆ¶å¯æ‰§è¡Œæ–‡ä»¶å®‰è£…</summary>

`é€šè¿‡ npm uninstall -g packagename`å¯ä»¥åŒæ—¶å¸è½½å…¨å±€åŒ…å’Œå®ƒçš„äºŒè¿›åˆ¶æ‰§è¡Œæ–‡ä»¶ã€‚é‚£ä¹ˆæ ¹æ®`unlink`æ˜¯`uninstall`çš„åˆ«åï¼Œå¯ä»¥å¾ˆå®¹æ˜“æ¨å‡ºå¦å¤–ä¸€ä¸ªç­‰ä»·æŒ‡ä»¤ï¼š

> npm unlink \[-g\]

</details>

<details>
<summary>ä¸ç¬¦åˆé¢„æœŸçš„è½¯é“¾æ¥åˆ é™¤</summary>

æ¯ä¸€æ¬¡çš„`npm link`ï¼Œéƒ½æ˜¯ä¸€æ¬¡**é‡æ–°å»ºç«‹è½¯é“¾æ¥**çš„è¿‡ç¨‹ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¼šå–æ¶ˆä¹‹å‰å·²ç»é“¾æ¥çš„åŒ…ã€‚

å¦‚æœä½ æƒ³åŒæ—¶ä¿ç•™å¤šä¸ªåŒ…çš„è½¯é“¾æ¥ï¼Œè®°å¾—åŒæ—¶`link`å¤šä¸ªï¼š

> npm link ../packageA ../packageB

</details>

è¿™ä¹ˆä¸€åˆ†æï¼Œå¥½åƒä¹Ÿå°±ä¸æ˜¯é—®é¢˜äº†...ğŸ˜‚ğŸ˜‚ğŸ˜‚ ä¸è¿‡è¿˜æ˜¯ä»‹ç»ä¸€ä¸‹å¦å¤–çš„ä¸¤ç§æ–¹å¼ï¼š

### `npm install`æ›¿ä»£

ä½¿ç”¨å®‰è£…æŒ‡ä»¤ï¼Œæ‹¼ä¸Š`ä½ è‡ªå®šä¹‰çš„æ¨¡å—çš„è·¯å¾„åœ°å€ï¼Œå¯ä»¥æ˜¯ç›¸å¯¹è·¯å¾„`ï¼Œè¿™ç§æ–¹å¼åŒæ ·æ˜¯å»ºç«‹è½¯é“¾æ¥ï¼Œå¹¶ä¸æ˜¯çœŸçš„å°†èµ„æºä¸‹è½½åˆ°`node_modules`ï¼Œåªä¸è¿‡å°‘äº†ä¸ª`global`çš„ä¸­é—´è¿‡ç¨‹ã€‚è²Œä¼¼æ›´åŠ æ–¹ä¾¿ä¸€ç‚¹ã€‚

> npm install \<package-path\>

å¦‚æœä½ ä¸æƒ³å†™å…¥`package.json`ï¼Œå¯ä»¥å¸¦ä¸Š`--no-save`å‚æ•°ï¼š

> npm install --no-save \<package-path\>

å–æ¶ˆçš„è¯ï¼Œå¯ä»¥ç”¨`uninstall`ï¼š

> npm uninstall package-path

### æ‰©å±•ã€ä»…åšäº†è§£ã€‘

é€šè¿‡`link`å·¥å…·é¿å…ä¸Šé¢æåˆ°çš„é—®é¢˜ã€‚[-> è¯¦è§](https://github.com/privatenumber/link)

```bash
npm i -g link
# æ–¹å¼ä¸€
npx link package-path
# æ–¹å¼äºŒï¼šé¡¹ç›®æ ¹ç›®å½•æ·»åŠ  link.config.json é…ç½®æ–‡ä»¶ï¼Œå†æ‰§è¡Œ
npx link
```
